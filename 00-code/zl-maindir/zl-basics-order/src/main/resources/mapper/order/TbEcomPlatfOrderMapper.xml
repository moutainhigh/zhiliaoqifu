<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ebeijia.zl.shop.dao.order.mapper.TbEcomPlatfOrderMapper">

    <sql id="PlatfOrderColumns">
      po.order_id,
      po.member_id,
      po.dms_related_key,
      po.pay_status,
      po.order_price,
      po.order_freight_amt,
      po.pay_type,
      po.pay_amt,
      po.pay_time,
      po.order_channel,
      po.col1,
      po.col2,
      po.col3,
      po.data_stat,
      po.remarks,
      po.create_user,
      po.update_user,
      po.create_time,
      po.update_time,
      po.lock_version
    </sql>

    <sql id="tableName">
      tb_ecom_platf_order po
    </sql>

    <select id="getPlatfOrderList" parameterType="TbEcomPlatfOrder" resultType="TbEcomPlatfOrder">
        select
          <include refid="PlatfOrderColumns" />,
          p.mobile_phone_no as mobilePhoneNo,
          p.personal_name as personalName
        from
          <include refid="tableName" />,
          tb_ecom_member m,tb_person_inf p
        where po.member_id = m.member_id
          and m.person_id = p.personal_id
          and po.data_stat = '0'
        <if test="orderId !=null and orderId !='' ">
          and po.order_id = #{orderId}
        </if>
        <if test="personalName !=null and personalName !='' ">
          and p.personal_name = #{personalName}
        </if>
        <if test="dmsRelatedKey !=null and dmsRelatedKey !='' ">
          and po.dms_related_key = #{dmsRelatedKey}
        </if>
        <if test="mobilePhoneNo !=null and mobilePhoneNo !='' ">
          and p.mobile_phone_no = #{mobilePhoneNo}
        </if>
        <if test="payStatus !=null and payStatus !='' ">
          and po.pay_status = #{payStatus}
        </if>
        <if test="payType !=null and payType !='' ">
          and po.pay_type = #{payType}
        </if>
        order by po.create_time desc
    </select>
</mapper>